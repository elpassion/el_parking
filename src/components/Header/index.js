import { format } from 'date-fns';
import { route } from 'preact-router';
import classNames from 'classnames';
import { inject, observer } from 'mobx-react';
import routeMap from '../../utils/routeMap';

import style from './style.scss';

const Header = ({ className, isDark, isLight, authStore, appStore }) => {
  const LogOutIcon = ({ ...props }) => (
    <svg xmlns='http://www.w3.org/2000/svg' width='25' height='25' className={`${style.icon} ${style.powerIcon}`} {...props}>
      <g className={style.powerIconFill} fillRule='evenodd'>
        <path d='M12.499.064C5.64.064.065 5.648.065 12.504c0 6.858 5.575 12.433 12.434 12.433 6.857 0 12.435-5.575 12.435-12.432S19.356.064 12.499.064zm0 23.591c-6.151 0-11.156-5-11.156-11.151 0-6.159 5.006-11.159 11.156-11.159 6.147 0 11.154 5 11.154 11.159 0 6.15-5.005 11.151-11.154 11.151z' />
        <path d='M13.14 6.844V4.783a.638.638 0 0 0-.641-.64.639.639 0 0 0-.643.64v2.061a5.7 5.7 0 0 0-5.05 5.66 5.697 5.697 0 0 0 5.693 5.692 5.7 5.7 0 0 0 5.694-5.692 5.701 5.701 0 0 0-5.054-5.66zm-.641 10.071a4.42 4.42 0 0 1-4.416-4.411 4.42 4.42 0 0 1 3.774-4.366v4.366c0 .35.288.633.643.633.352 0 .64-.282.64-.633V8.137a4.421 4.421 0 0 1 3.778 4.367 4.424 4.424 0 0 1-4.42 4.411z' />
      </g>
    </svg>
  );

  const SettingsIcon = ({ ...props }) => (
    <svg xmlns='http://www.w3.org/2000/svg' width='25' height='25' className={`${style.icon} ${style.settingsIcon}`} {...props}>
      <g className={style.settingsIconFill} fillRule='evenodd'>
        <path d='M14.1711735,16.175 C14.1103878,16.2128673 14.0376429,16.2437577 13.9668929,16.260699 C11.1957194,16.9173827 9.4975051,15.4465663 8.88679082,13.9866939 C8.27495408,12.5268214 8.41745408,10.2826122 10.8279643,8.76220408 C10.8877551,8.72334184 10.9604974,8.69344643 11.0302526,8.6765051 C11.5006097,8.56489796 11.9370638,8.51407653 12.3456097,8.51407653 C14.3465791,8.51407653 15.6050485,9.73578571 16.1134668,10.9495102 C16.7253036,12.4103776 16.583824,14.6553776 14.1712985,16.1750204 L14.1711735,16.175 Z M24.3315026,14.5746633 L23.103824,13.4745357 C22.9742806,13.3579464 22.8995434,13.1915255 22.8995434,13.0171378 L22.8995434,11.8143827 C22.8995434,11.6419898 22.9722883,11.4765765 23.0998393,11.3609898 L24.3125689,10.253898 C24.8855536,9.7297398 25.0699158,8.89667857 24.7689719,8.17920408 L24.1511403,6.70338776 C23.8521862,5.98591327 23.1367015,5.5355051 22.3534617,5.57535204 L20.6673903,5.67001786 C20.4900153,5.68197602 20.2996862,5.6052449 20.174125,5.4647398 L19.3699668,4.55792857 C19.2643393,4.43735204 19.2085357,4.28190816 19.2165077,4.12047959 L19.2902474,2.53405102 C19.3261199,1.75678061 18.866727,1.03632143 18.1482577,0.742367347 L16.6704515,0.1365 C15.9499923,-0.157454082 15.1209107,0.0328647959 14.6027219,0.612826531 L13.5045842,1.8434898 C13.3879949,1.97303316 13.2225689,2.04777041 13.0481811,2.04777041 L11.8484107,2.04777041 C11.6760179,2.04777041 11.5106046,1.97502551 11.3950179,1.84747449 L10.2909107,0.632755102 C9.76774745,0.0577806122 8.93568112,-0.125586735 8.21920153,0.174362245 L6.74540051,0.794183673 C6.02991582,1.09512755 5.57851276,1.81857143 5.6213699,2.59584184 L5.71205102,4.24403061 C5.72201607,4.41841582 5.6572449,4.58783163 5.53367857,4.71137755 L4.68467347,5.56237245 C4.56310204,5.68394388 4.39569388,5.75569133 4.22329592,5.7417398 L2.58505612,5.6650102 C1.81179082,5.63013265 1.09130612,6.08853061 0.797352041,6.8089898 L0.192479592,8.28978061 C-0.10147449,9.0102398 0.0898418367,9.84230612 0.668806122,10.3614898 L1.8954898,11.4616173 C2.02603061,11.5772092 2.09977041,11.7446276 2.09977041,11.9190153 L2.09977041,13.1217704 C2.09977041,13.2941633 2.02702551,13.4595765 1.89947449,13.5761582 L0.687739796,14.6822551 C0.113760204,15.2064133 -0.0696071429,16.0404694 0.230341837,16.756949 L0.848173469,18.2327653 C1.14911735,18.9502398 1.86360714,19.4026378 2.64684694,19.360801 L4.29105612,19.2691224 C4.47341327,19.2621469 4.63585204,19.324926 4.75939796,19.4474949 L5.60740816,20.2984898 C5.72897959,20.4200612 5.79475,20.5884643 5.78578061,20.7608622 L5.71004592,22.4020867 C5.67417347,23.1793571 6.13254592,23.8998163 6.85104082,24.1937704 L8.32984184,24.7996378 C8.55504847,24.8913163 8.79022449,24.9361582 9.02440816,24.9361582 C9.53859184,24.9361582 10.0418316,24.7209158 10.3975714,24.3223316 L11.4957092,23.0926633 C11.611301,22.9631199 11.7777245,22.8883827 11.9521122,22.8883827 L13.1518827,22.8883827 C13.3242755,22.8883827 13.4896888,22.9611276 13.6052755,23.0886786 L14.7093827,24.303398 C15.2325459,24.8773776 16.066602,25.0617398 16.7810918,24.7617908 L18.253898,24.1419694 C18.9703776,23.8410255 19.4217806,23.1165867 19.378949,22.3393163 L19.2882679,20.6941122 C19.2783028,20.5187296 19.343074,20.3473265 19.4666403,20.2247755 L20.3156454,19.3737806 C20.4372168,19.2522092 20.6076097,19.1814566 20.777023,19.1944133 L22.4142679,19.2711429 C23.1905434,19.305023 23.9090128,18.8476224 24.2029668,18.1271633 L24.8078393,16.6463724 C25.1017934,15.9259133 24.910477,15.0938469 24.3315128,14.5746633 L24.3315026,14.5746633 Z M23.6718342,16.1810153 L23.0679566,17.662801 C22.970301,17.9029566 22.7211709,18.0643827 22.4720638,18.0434643 L20.833824,17.9667347 C20.3236199,17.9468046 19.8124209,18.1391276 19.4477015,18.5048469 L18.5996913,19.3558418 C18.2299974,19.7265306 18.0346913,20.2377296 18.0635689,20.7608929 L18.1552474,22.4080867 C18.1691982,22.6671684 18.018727,22.9083163 17.7795587,23.0089796 L16.3067526,23.6278061 C16.0685918,23.7274541 15.7905791,23.6666684 15.6161913,23.4753418 L14.5120842,22.2606224 C14.1643036,21.8789643 13.6690485,21.6597296 13.1518801,21.6597296 L11.9521097,21.6597296 C11.4299413,21.6597296 10.9307066,21.8829439 10.5809362,22.2735561 L9.48279847,23.5032245 C9.31040561,23.6965434 9.0343801,23.7603163 8.79422704,23.6616658 L7.31642092,23.0557985 C7.07626531,22.9581429 6.92379337,22.7179923 6.93476276,22.4589107 L7.01149235,20.8186811 C7.03540816,20.3015128 6.84009439,19.7952883 6.474375,19.429574 L5.6263648,18.5785791 C5.28057398,18.2327883 4.81123724,18.0394719 4.32394133,18.0394719 C4.29105612,18.0394719 4.25717602,18.0404684 4.22329592,18.0424612 L2.57908673,18.1331423 C2.30704592,18.1490862 2.07885714,17.9976194 1.97918878,17.7584485 L1.36135714,16.2826321 C1.26170663,16.0424765 1.3234898,15.7654638 1.51382143,15.591076 L2.72655102,14.4839842 C3.10721429,14.1352087 3.32644898,13.6389587 3.32644898,13.1217903 L3.32644898,11.9190352 C3.32644898,11.394877 3.10223724,10.8946474 2.71361735,10.5458719 L1.48593878,9.44574439 C1.2936148,9.27235408 1.22984184,8.99533622 1.32849235,8.75518316 L1.9323699,7.27339745 C2.03002551,7.03324184 2.2921148,6.87579541 2.52826276,6.89273418 L4.16550765,6.96946378 C4.69165561,6.99039031 5.18691071,6.79607347 5.5516301,6.43135153 L6.4006352,5.58035663 C6.77132398,5.20966786 6.96665561,4.69747398 6.93675765,4.17530561 L6.84607653,2.52811173 C6.83112908,2.2680352 6.98159949,2.02788214 7.22077041,1.92721888 L8.69357653,1.30839235 C8.93074235,1.20774694 9.2077602,1.26853265 9.38314286,1.46085663 L10.4882449,2.67557602 C10.8350306,3.05723418 11.3312806,3.27646888 11.848449,3.27646888 L13.0482194,3.27646888 C13.5713827,3.27646888 14.0706173,3.05225714 14.418398,2.66264235 L15.5165357,1.43297398 C15.6879337,1.2396551 15.9669439,1.17389235 16.2051071,1.2735352 L17.6839082,1.87940255 C17.9240638,1.97805561 18.0765357,2.21720867 18.0645714,2.47629031 L17.9908316,4.06371378 C17.9679122,4.54700459 18.1333291,5.01136684 18.454199,5.37310153 L19.2583571,6.27991276 C19.633051,6.70343316 20.1761378,6.92463214 20.7351684,6.89674949 L22.4212398,6.80307857 C22.689301,6.78613801 22.9204745,6.93959898 23.0211378,7.17777245 L23.6379745,8.65458367 C23.7386199,8.89374184 23.6768367,9.17075714 23.4855102,9.3461398 L22.2737755,10.4522367 C21.8931122,10.8010122 21.6728827,11.2972622 21.6728827,11.8144306 L21.6728827,13.0171857 C21.6728827,13.540349 21.8960969,14.0415735 22.2867092,14.390349 L23.5133929,15.4904765 C23.7067117,15.6638668 23.7704847,15.9408847 23.6718342,16.1810378 L23.6718342,16.1810153 Z M10.7483648,7.4807602 C10.547074,7.52859184 10.3497679,7.61229592 10.1743852,7.72191071 C7.311375,9.52854337 6.89683418,12.4094107 7.75589031,14.4622168 C8.4703801,16.1702015 10.2102526,17.6489515 12.6706862,17.6489515 C13.1679311,17.6489515 13.6960689,17.5871684 14.250125,17.4566276 C14.4504209,17.4087959 14.6487219,17.3260867 14.8231097,17.215477 C17.688926,15.4098393 18.1044872,12.527977 17.2445893,10.4731301 C16.3846148,8.41935459 14.043824,6.6983852 10.7484158,7.48078316 L10.7483648,7.4807602' />
      </g>
    </svg>
  );

  const today = new Date();
  const headerClass = classNames(className, style.header, {
      [style.isDark]: isDark,
      [style.isLight]: isLight,
  });

  return (
    <header className={headerClass}>
      <div className={style.headerDate}>
        <span>
          Dzi≈õ
        </span>
        <time className={style.dateToday} dateTime={today}>
          {format(today, 'DD.MM.YYYY')}
        </time>
      </div>
      <div className={style.headerAction}>
        <SettingsIcon onClick={() => { route('/settings'); }} />
        <LogOutIcon onClick={authStore.logout} />
      </div>
    </header>
  );
};

export default inject('authStore', 'appStore')(observer(Header));
